<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#4F46E5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>üêµ Weekend Monkeys - Ultimate Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    :root {
        --primary: #4F46E5;
        --secondary: #764ba2;
        --success: #10B981;
        --danger: #EF4444;
        --warning: #F97316;
        --gold: #F59E0B;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 12px;
        color: #1F2937;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
    }

    .container {
        max-width: 900px;
        margin: 0 auto;
    }

    /* Crystal Clear Cards */
    .card {
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px) saturate(180%);
        border-radius: 20px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.12);
        border: 1px solid rgba(255, 255, 255, 0.5);
    }

    .header {
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 24px;
        margin-bottom: 20px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    }

    .header h1 {
        font-size: 28px;
        font-weight: 800;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: -0.02em;
        margin-bottom: 16px;
    }

    /* Tabs */
    .tabs {
        display: flex;
        gap: 8px;
        margin-bottom: 16px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }

    .tab-btn {
        padding: 12px 20px;
        border: none;
        background: #F3F4F6;
        border-radius: 14px;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        white-space: nowrap;
    }

    .tab-btn:hover {
        background: #E5E7EB;
        transform: translateY(-2px);
    }

    .tab-btn.active {
        background: var(--primary);
        color: white;
        box-shadow: 0 4px 16px rgba(79, 70, 229, 0.4);
    }

    .tab-content {
        display: none;
    }

    .tab-content.active {
        display: block;
        animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Controls */
    .controls {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        align-items: center;
    }

    .controls input, .controls select, .controls button {
        padding: 12px 18px;
        border: 2px solid #E5E7EB;
        border-radius: 14px;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.2s;
    }

    .controls button {
        background: var(--primary);
        color: white;
        border: none;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(79, 70, 229, 0.2);
    }

    .controls button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(79, 70, 229, 0.3);
    }

    .controls button:active {
        transform: translateY(0);
    }

    .btn-success { background: var(--success) !important; }
    .btn-danger { background: var(--danger) !important; }
    .btn-warning { background: var(--warning) !important; }

    /* Player Card */
    .player-card {
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        border-radius: 18px;
        padding: 20px;
        margin-bottom: 16px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        border-left: 6px solid;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .player-card:hover {
        box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        transform: translateY(-2px);
    }

    .player-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 14px;
    }

    .player-name {
        font-size: 20px;
        font-weight: 700;
        letter-spacing: -0.01em;
    }

    .player-score {
        font-size: 32px;
        font-weight: 800;
    }

    .status-badge {
        padding: 6px 14px;
        border-radius: 14px;
        font-size: 13px;
        font-weight: 700;
        color: white;
    }

    .status-in { background: var(--success); }
    .status-out { 
        background: var(--danger);
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }

    .dealer-badge {
        background: var(--warning);
        color: white;
        padding: 5px 12px;
        border-radius: 14px;
        font-size: 12px;
        font-weight: 700;
    }

    /* Undo Button */
    .undo-btn {
        position: fixed;
        bottom: 24px;
        right: 24px;
        width: 64px;
        height: 64px;
        border-radius: 50%;
        background: var(--primary);
        color: white;
        border: none;
        font-size: 28px;
        cursor: pointer;
        box-shadow: 0 8px 24px rgba(79, 70, 229, 0.4);
        z-index: 999;
        transition: all 0.3s;
    }

    .undo-btn:hover:not(:disabled) {
        transform: scale(1.1) rotate(-15deg);
    }

    .undo-btn:disabled {
        background: #9CA3AF;
        cursor: not-allowed;
        opacity: 0.5;
    }

    /* Stats Grid */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 16px;
        margin: 20px 0;
    }

    .stat-card {
        background: white;
        border-radius: 16px;
        padding: 20px;
        text-align: center;
        box-shadow: 0 4px 16px rgba(0,0,0,0.06);
    }

    .stat-value {
        font-size: 36px;
        font-weight: 800;
        color: var(--primary);
    }

    .stat-label {
        font-size: 13px;
        color: #6B7280;
        font-weight: 600;
        margin-top: 8px;
    }

    /* History List */
    .history-item {
        background: white;
        border-radius: 14px;
        padding: 16px;
        margin-bottom: 12px;
        border-left: 4px solid var(--primary);
        cursor: pointer;
        transition: all 0.2s;
    }

    .history-item:hover {
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        transform: translateX(4px);
    }

    /* Modal */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.6);
        backdrop-filter: blur(8px);
    }

    .modal-content {
        background: white;
        margin: 5% auto;
        padding: 32px;
        border-radius: 24px;
        width: 90%;
        max-width: 700px;
        max-height: 85vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
        from { opacity: 0; transform: translateY(50px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 2px solid #F3F4F6;
    }

    .modal-header h2 {
        color: var(--primary);
        font-size: 24px;
        font-weight: 800;
    }

    .close-btn {
        font-size: 32px;
        border: none;
        background: none;
        cursor: pointer;
        color: #9CA3AF;
        transition: all 0.2s;
    }

    .close-btn:hover {
        color: #374151;
        transform: rotate(90deg);
    }

    /* Winner Section */
    .winner-section {
        background: linear-gradient(135deg, #FCD34D 0%, #F59E0B 100%);
        border-radius: 20px;
        padding: 40px;
        text-align: center;
        margin-bottom: 30px;
        box-shadow: 0 12px 40px rgba(245, 158, 11, 0.4);
    }

    .winner-crown {
        font-size: 100px;
        animation: bounce 2s infinite;
    }

    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-20px); }
    }

    .winner-monkey { font-size: 120px; }
    
    .winner-title {
        font-size: 42px;
        font-weight: 800;
        color: #78350F;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        margin: 20px 0;
    }

    .winner-name {
        font-size: 36px;
        font-weight: 700;
        color: #1F2937;
    }

    /* Tables */
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 16px 0;
    }

    th, td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #E5E7EB;
    }

    th {
        background: #F3F4F6;
        font-weight: 700;
    }

    .winner-row {
        background: #FEF3C7 !important;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .header h1 { font-size: 22px; }
        .player-name { font-size: 18px; }
        .player-score { font-size: 28px; }
        .winner-crown { font-size: 70px; }
        .winner-title { font-size: 28px; }
        .stats-grid { grid-template-columns: 1fr 1fr; }
    }
</style>
```

</head>
<body>
    <button class="undo-btn" id="undoBtn" title="Undo Last Action" disabled>‚Ü©Ô∏è</button>

```
<div class="container">
    <div class="header">
        <h1>üêµ Weekend Monkeys Score Board - Ultimate</h1>
        
        <div class="tabs">
            <button class="tab-btn active" data-tab="game">üéÆ Game</button>
            <button class="tab-btn" data-tab="history">üìö History</button>
            <button class="tab-btn" data-tab="stats">üìà Statistics</button>
        </div>

        <div class="tab-content active" id="game-tab">
            <div class="controls">
                <input type="text" id="gameName" placeholder="Game name" value="Rummy" style="flex:1; min-width:120px;">
                <label style="font-weight:600;">Target:</label>
                <input type="number" id="targetPoint" value="330" style="width:90px;">
                <label style="font-weight:600;">Sort:</label>
                <select id="sortBy" style="width:110px;">
                    <option value="default">Default</option>
                    <option value="name">Name</option>
                    <option value="points">Points</option>
                </select>
                <button id="soundToggle">üîä</button>
                <button class="btn-warning" id="resetPointsBtn">üîÑ Points</button>
                <button class="btn-danger" id="resetPlayersBtn">‚ùå Players</button>
                <button class="btn-success" id="reportBtn">üìã Report</button>
            </div>
        </div>

        <div class="tab-content" id="history-tab">
            <div class="controls">
                <button class="btn-success" id="saveGameBtn">üíæ Save Game</button>
                <button class="btn-primary" id="loadGamesBtn">üìÇ Load Game</button>
                <button class="btn-danger" id="clearHistoryBtn">üóëÔ∏è Clear History</button>
            </div>
        </div>

        <div class="tab-content" id="stats-tab">
            <div class="controls">
                <button class="btn-primary" id="viewStatsBtn">üìä View All Stats</button>
                <button class="btn-success" id="refreshStatsBtn">üîÑ Refresh</button>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="controls">
            <input type="text" id="newPlayerName" placeholder="Enter player name" style="flex:1;">
            <button class="btn-success" id="addPlayerBtn">‚ûï Add Player</button>
        </div>
    </div>

    <div id="playersList"></div>
</div>

<div id="reportModal" class="modal"></div>
<div id="historyModal" class="modal"></div>
<div id="statsModal" class="modal"></div>

<script>
    const sounds = {
        enabled: true,
        play(freq, dur) {
            if (!this.enabled) return;
            try {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.frequency.value = freq;
                gain.gain.setValueAtTime(0.3, ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + dur);
                osc.start();
                osc.stop(ctx.currentTime + dur);
            } catch(e) {}
        },
        add() { this.play(523, 0.1); setTimeout(() => this.play(659, 0.1), 80); },
        remove() { this.play(392, 0.15); },
        dealer() { this.play(440, 0.1); setTimeout(() => this.play(659, 0.15), 100); },
        out() { this.play(880, 0.1); setTimeout(() => this.play(523, 0.2), 150); },
        winner() { this.play(523, 0.15); setTimeout(() => this.play(783, 0.15), 150); setTimeout(() => this.play(1047, 0.3), 300); },
        click() { this.play(800, 0.05); }
    };

    const COLORS = ['#FFE5E5','#E5F3FF','#FFF5E5','#E5FFE5','#FFE5FF','#E5FFFF','#F5E5FF','#FFFFE5','#FFE5F0'];
    
    const INITIAL_PLAYERS = [
        {name:'HABIN',color:'#FFE5E5'},{name:'NOUFAL',color:'#E5F3FF'},{name:'EMAD',color:'#FFF5E5'},
        {name:'MUBASHIR',color:'#E5FFE5'},{name:'LEO',color:'#FFE5FF'},{name:'ASIF',color:'#E5FFFF'},
        {name:'SHABIN',color:'#F5E5FF'},{name:'MUTHU',color:'#FFFFE5'},{name:'SALMAN',color:'#FFE5F0'}
    ];

    let state = {
        gameName: 'Rummy',
        targetPoint: 330,
        players: INITIAL_PLAYERS.map((p,i) => ({...p, id:Date.now()+i, scores:[], dealerHistory:[]})),
        sortBy: 'default',
        nextId: Date.now() + INITIAL_PLAYERS.length,
        roundDealers: [],
        undoStack: [],
        gameHistory: [],
        playerStats: {}
    };

    function load() {
        const saved = localStorage.getItem('monkeysUltimate');
        if (saved) {
            try {
                const data = JSON.parse(saved);
                state = {...state, ...data};
            } catch(e) {}
        }
        sounds.enabled = localStorage.getItem('soundEnabled') !== 'false';
    }

    function save() {
        localStorage.setItem('monkeysUltimate', JSON.stringify(state));
        localStorage.setItem('soundEnabled', sounds.enabled);
    }

    function pushUndo(action) {
        state.undoStack.push(JSON.parse(JSON.stringify(action)));
        if (state.undoStack.length > 20) state.undoStack.shift();
        document.getElementById('undoBtn').disabled = false;
        save();
    }

    function undo() {
        if (state.undoStack.length === 0) return;
        const action = state.undoStack.pop();
        
        if (action.type === 'addScore') {
            const p = state.players.find(pl => pl.id === action.playerId);
            if (p && p.scores.length > 0) p.scores.pop();
        } else if (action.type === 'removeScore') {
            const p = state.players.find(pl => pl.id === action.playerId);
            if (p) p.scores.push(action.score);
        } else if (action.type === 'addPlayer') {
            state.players = state.players.filter(p => p.id !== action.playerId);
        } else if (action.type === 'setDealer') {
            if (action.roundIndex >= 0) {
                state.roundDealers[action.roundIndex] = action.previousDealer;
            }
        }
        
        document.getElementById('undoBtn').disabled = state.undoStack.length === 0;
        sounds.click();
        save();
        render();
    }

    function getSorted() {
        let sorted = [...state.players];
        if (state.sortBy === 'name') sorted.sort((a,b) => a.name.localeCompare(b.name));
        else if (state.sortBy === 'points') sorted.sort((a,b) => getTotal(b) - getTotal(a));
        return sorted;
    }

    function getTotal(p) { return p.scores.reduce((s,v) => s+v, 0); }
    function getMaxRounds() { return Math.max(...state.players.map(p => p.scores.length), 0); }
    
    function getWinner() {
        const withScores = state.players.filter(p => p.scores.length > 0);
        if (withScores.length === 0) return null;
        return withScores.reduce((low, p) => getTotal(p) < getTotal(low) ? p : low);
    }

    function addPlayer() {
        const input = document.getElementById('newPlayerName');
        const name = input.value.trim().toUpperCase();
        if (!name) return alert('Please enter a player name');
        if (state.players.some(p => p.name === name)) return alert('Player already exists');
        
        const player = {
            id: state.nextId++,
            name,
            color: COLORS[state.players.length % COLORS.length],
            scores: [],
            dealerHistory: []
        };
        
        state.players.push(player);
        pushUndo({type: 'addPlayer', playerId: player.id});
        input.value = '';
        sounds.click();
        save();
        render();
    }

    function addScore(id) {
        const input = document.getElementById(`score-${id}`);
        const score = parseInt(input.value);
        if (isNaN(score)) return;
        
        const p = state.players.find(pl => pl.id === id);
        if (!p) return;
        
        const wasOut = getTotal(p) >= state.targetPoint;
        p.scores.push(score);
        const isOut = getTotal(p) >= state.targetPoint;
        
        pushUndo({type: 'addScore', playerId: id, score});
        
        input.value = '';
        sounds.add();
        
        if (!wasOut && isOut) {
            sounds.out();
            const card = document.querySelector(`[data-player-id="${id}"]`);
            if (card) {
                card.style.animation = 'none';
                setTimeout(() => card.style.animation = 'pulse 0.5s', 10);
            }
        }
        
        updateStats();
        save();
        render();
    }

    function removeScore(id) {
        const p = state.players.find(pl => pl.id === id);
        if (!p || p.scores.length === 0) return;
        
        const score = p.scores.pop();
        pushUndo({type: 'removeScore', playerId: id, score});
        
        sounds.remove();
        save();
        render();
    }

    function setDealer(id) {
        const round = getMaxRounds();
        const p = state.players.find(pl => pl.id === id);
        if (!p) return;
        
        const prev = state.roundDealers[round];
        state.roundDealers[round] = p.name;
        pushUndo({type: 'setDealer', roundIndex: round, previousDealer: prev});
        
        sounds.dealer();
        save();
        render();
    }

    function updateStats() {
        state.players.forEach(p => {
            if (!state.playerStats[p.name]) {
                state.playerStats[p.name] = {
                    gamesPlayed: 0,
                    wins: 0,
                    totalScore: 0,
                    bestScore: Infinity,
                    worstScore: 0
                };
            }
        });
    }

    function saveGame() {
        if (state.players.length === 0) return alert('No players to save');
        
        const gameName = prompt('Enter a name for this game:', state.gameName + ' - ' + new Date().toLocaleDateString());
        if (!gameName) return;
        
        const gameData = {
            name: gameName,
            date: new Date().toISOString(),
            gameName: state.gameName,
            targetPoint: state.targetPoint,
            players: JSON.parse(JSON.stringify(state.players)),
            roundDealers: [...state.roundDealers],
            winner: getWinner()
        };
        
        state.gameHistory.push(gameData);
        
        // Update player stats
        const winner = getWinner();
        state.players.forEach(p => {
            const total = getTotal(p);
            if (total > 0) {
                const stats = state.playerStats[p.name];
                stats.gamesPlayed++;
                if (winner && p.id === winner.id) stats.wins++;
                stats.totalScore += total;
                stats.bestScore = Math.min(stats.bestScore, total);
                stats.worstScore = Math.max(stats.worstScore, total);
            }
        });
        
        sounds.click();
        save();
        alert('‚úÖ Game saved successfully!');
    }

    function loadGames() {
        if (state.gameHistory.length === 0) {
            return alert('No saved games found');
        }
        
        let html = `
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìö Game History</h2>
                    <button class="close-btn" onclick="closeModal('historyModal')">&times;</button>
                </div>
                <div style="max-height:60vh; overflow-y:auto;">
        `;
        
        state.gameHistory.forEach((game, i) => {
            const date = new Date(game.date).toLocaleString();
            const winner = game.winner ? game.winner.name : 'No winner';
            html += `
                <div class="history-item" onclick="loadGame(${i})">
                    <div style="font-weight:700; font-size:16px;">${game.name}</div>
                    <div style="color:#6B7280; font-size:13px; margin-top:4px;">
                        ${date} ‚Ä¢ ${game.players.length} players ‚Ä¢ Winner: ${winner}
                    </div>
                </div>
            `;
        });
        
        html += `</div></div>`;
        
        document.getElementById('historyModal').innerHTML = html;
        document.getElementById('historyModal').style.display = 'block';
    }

    function loadGame(index) {
        if (!confirm('Load this game? Current game will be lost if not saved.')) return;
        
        const game = state.gameHistory[index];
        state.gameName = game.gameName;
        state.targetPoint = game.targetPoint;
        state.players = JSON.parse(JSON.stringify(game.players));
        state.roundDealers = [...game.roundDealers];
        state.undoStack = [];
        
        document.getElementById('gameName').value = state.gameName;
        document.getElementById('targetPoint').value = state.targetPoint;
        
        sounds.click();
        closeModal('historyModal');
        save();
        render();
        alert('‚úÖ Game loaded successfully!');
    }

    function clearHistory() {
        if (!confirm('‚ö†Ô∏è Delete ALL game history? This cannot be undone!')) return;
        state.gameHistory = [];
        sounds.click();
        save();
        alert('‚úÖ History cleared!');
    }

    function viewStats() {
        if (Object.keys(state.playerStats).length === 0) {
            return alert('No statistics available yet. Play some games!');
        }
        
        let html = `
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìà Player Statistics</h2>
                    <button class="close-btn" onclick="closeModal('statsModal')">&times;</button>
                </div>
                <div class="stats-grid">
        `;
        
        Object.entries(state.playerStats).forEach(([name, stats]) => {
            const avg = stats.gamesPlayed > 0 ? (stats.totalScore / stats.gamesPlayed).toFixed(1) : 0;
            const winRate = stats.gamesPlayed > 0 ? ((stats.wins / stats.gamesPlayed) * 100).toFixed(0) : 0;
            const best = stats.bestScore === Infinity ? 0 : stats.bestScore;
            
            html += `
                <div class="stat-card">
                    <div style="font-size:18px; font-weight:700; margin-bottom:16px;">${name}</div>
                    <div class="stat-value">${stats.gamesPlayed}</div>
                    <div class="stat-label">Games Played</div>
                    <div style="margin-top:16px;">
                        <div style="font-size:20px; font-weight:700; color:var(--success);">${stats.wins}</div>
                        <div class="stat-label">Wins (${winRate}%)</div>
                    </div>
                    <div style="margin-top:16px;">
                        <div style="font-size:18px; font-weight:600;">${avg}</div>
                        <div class="stat-label">Avg Score</div>
                    </div>
                    <div style="margin-top:12px; display:flex; justify-content:space-around;">
                        <div>
                            <div style="font-size:16px; font-weight:600; color:var(--success);">${best}</div>
                            <div style="font-size:11px; color:#9CA3AF;">Best</div>
                        </div>
                        <div>
                            <div style="font-size:16px; font-weight:600; color:var(--danger);">${stats.worstScore}</div>
                            <div style="font-size:11px; color:#9CA3AF;">Worst</div>
                        </div>
                    </div>
                </div>
            `;
        });
        
        html += `</div></div>`;
        
        document.getElementById('statsModal').innerHTML = html;
        document.getElementById('statsModal').style.display = 'block';
    }

    function showReport() {
        const winner = getWinner();
        const maxRounds = getMaxRounds();
        
        let html = `
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìã Game Report</h2>
                    <button class="close-btn" onclick="closeModal('reportModal')">&times;</button>
                </div>
        `;
        
        if (winner) {
            sounds.winner();
            html += `
                <div class="winner-section">
                    <div class="winner-crown">üëë</div>
                    <div class="winner-monkey">üêµ</div>
                    <div class="winner-title">CHAMPION!</div>
                    <div class="winner-name">${winner.name}</div>
                    <div style="font-size:24px; color:#374151; margin-top:12px;">
                        Score: ${getTotal(winner)} points
                    </div>
                </div>
            `;
        }
        
        html += `
            <div style="margin-bottom:24px;">
                <h3 style="color:var(--primary); font-size:18px; margin-bottom:12px;">Game Info</h3>
                <p><strong>Game:</strong> ${state.gameName}</p>
                <p><strong>Target:</strong> ${state.targetPoint}</p>
                <p><strong>Players:</strong> ${state.players.length}</p>
                <p><strong>Rounds:</strong> ${maxRounds}</p>
            </div>
        `;
        
        if (maxRounds > 0) {
            html += `
                <div>
                    <h3 style="color:var(--primary); font-size:18px; margin-bottom:12px;">Scores</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Player</th>
                                ${Array.from({length: maxRounds}, (_, i) => `<th>R${i+1}</th>`).join('')}
                                <th>Total</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${state.players.map(p => {
                                const total = getTotal(p);
                                const isOut = total >= state.targetPoint;
                                const isWinner = winner && p.id === winner.id;
                                return `
                                    <tr class="${isWinner ? 'winner-row' : ''}">
                                        <td><strong>${p.name}${isWinner ? ' üëë' : ''}</strong></td>
                                        ${Array.from({length: maxRounds}, (_, i) => 
                                            `<td>${p.scores[i] !== undefined ? p.scores[i] : '-'}</td>`
                                        ).join('')}
                                        <td><strong>${total}</strong></td>
                                        <td>${isOut ? '‚ùå' : '‚úì'}</td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }
        
        html += `
            <button style="width:100%; padding:14px; background:var(--primary); color:white; border:none; border-radius:14px; font-size:16px; font-weight:700; cursor:pointer; margin-top:20px;" onclick="copyReport()">
                üìã Copy Report
            </button>
        </div>`;
        
        document.getElementById('reportModal').innerHTML = html;
        document.getElementById('reportModal').style.display = 'block';
    }

    function copyReport() {
        const winner = getWinner();
        const maxRounds = getMaxRounds();
        
        let text = `üêµ WEEKEND MONKEYS SCORE BOARD\n${'='.repeat(50)}\n\n`;
        
        if (winner) {
            text += `üëë CHAMPION: ${winner.name}\n`;
            text += `Score: ${getTotal(winner)} points\n\n`;
        }
        
        text += `GAME: ${state.gameName}\n`;
        text += `TARGET: ${state.targetPoint}\n`;
        text += `PLAYERS: ${state.players.length}\n`;
        text += `ROUNDS: ${maxRounds}\n\n`;
        
        if (maxRounds > 0) {
            text += `SCORES:\n${'-'.repeat(50)}\n`;
            text += 'Player'.padEnd(15);
            for (let i = 0; i < maxRounds; i++) text += `R${i+1}`.padEnd(8);
            text += 'Total\n';
            text += '-'.repeat(50) + '\n';
            
            state.players.forEach(p => {
                const total = getTotal(p);
                text += p.name.padEnd(15);
                for (let i = 0; i < maxRounds; i++) {
                    text += (p.scores[i] !== undefined ? p.scores[i] : '-').toString().padEnd(8);
                }
                text += total + '\n';
            });
        }
        
        text += `\n${'='.repeat(50)}\n`;
        text += `Generated: ${new Date().toLocaleString()}\n`;
        
        navigator.clipboard.writeText(text).then(() => {
            alert('‚úÖ Report copied! Paste in WhatsApp/Notes.');
        }).catch(() => {
            alert('‚ùå Copy failed. Please try again.');
        });
    }

    function closeModal(id) {
        document.getElementById(id).style.display = 'none';
    }

    function render() {
        const sorted = getSorted();
        const list = document.getElementById('playersList');
        
        list.innerHTML = sorted.map(p => {
            const total = getTotal(p);
            const isOut = total >= state.targetPoint;
            const round = getMaxRounds() + 1;
            const isDealer = state.roundDealers[round] === p.name;
            
            return `
                <div class="player-card" data-player-id="${p.id}" style="border-left-color:${p.color}; background-color:${p.color};">
                    <div class="player-header">
                        <div>
                            <div style="display:flex; align-items:center; gap:10px;">
                                <span class="player-name">${p.name}</span>
                                ${isDealer ? '<span class="dealer-badge">üÉè DEALER</span>' : ''}
                            </div>
                            <div style="font-size:13px; color:#6B7280; margin-top:6px;">
                                Rounds: ${p.scores.length}
                            </div>
                        </div>
                        <div style="text-align:right;">
                            <div class="player-score">${total}</div>
                            <span class="status-badge ${isOut ? 'status-out' : 'status-in'}">
                                ${isOut ? '‚ùå OUT' : '‚úì IN'}
                            </span>
                        </div>
                    </div>
                    
                    <div class="controls" style="margin-bottom:12px;">
                        <input type="number" id="score-${p.id}" placeholder="Score" style="flex:1;" data-player-id="${p.id}">
                        <button class="btn-success" data-action="add" data-id="${p.id}">‚ûï</button>
                        <button class="btn-warning" data-action="remove" data-id="${p.id}" ${p.scores.length === 0 ? 'disabled' : ''}>üóëÔ∏è</button>
                        <button class="${isDealer ? 'btn-warning' : ''}" data-action="dealer" data-id="${p.id}" style="${isDealer ? '' : 'background:#F3F4F6; color:#374151;'}">üÉè</button>
                    </div>
                    
                    ${p.scores.length > 0 ? `
                        <div style="display:flex; gap:6px; flex-wrap:wrap;">
                            ${p.scores.map((s, i) => `
                                <span style="background:white; padding:5px 12px; border-radius:12px; font-size:13px; font-weight:600;">
                                    R${i+1}: ${s}
                                </span>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `;
        }).join('');
        
        list.querySelectorAll('button[data-action]').forEach(btn => {
            btn.addEventListener('click', function() {
                const action = this.dataset.action;
                const id = parseInt(this.dataset.id);
                if (action === 'add') addScore(id);
                else if (action === 'remove') removeScore(id);
                else if (action === 'dealer') setDealer(id);
            });
        });
        
        list.querySelectorAll('input[data-player-id]').forEach(inp => {
            inp.addEventListener('keypress', e => {
                if (e.key === 'Enter') {
                    addScore(parseInt(inp.dataset.playerId));
                }
            });
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        load();
        
        document.getElementById('gameName').value = state.gameName;
        document.getElementById('targetPoint').value = state.targetPoint;
        document.getElementById('sortBy').value = state.sortBy;
        document.getElementById('soundToggle').textContent = sounds.enabled ? 'üîä' : 'üîá';
        
        render();
        
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                document.getElementById(this.dataset.tab + '-tab').classList.add('active');
                sounds.click();
            });
        });
        
        document.getElementById('soundToggle').addEventListener('click', function() {
            sounds.enabled = !sounds.enabled;
            this.textContent = sounds.enabled ? 'üîä' : 'üîá';
            if (sounds.enabled) sounds.click();
            save();
        });
        
        document.getElementById('undoBtn').addEventListener('click', undo);
        
        document.getElementById('resetPointsBtn').addEventListener('click', () => {
            if (confirm('‚ö†Ô∏è Reset all scores? Keeps players.')) {
                state.players.forEach(p => { p.scores = []; p.dealerHistory = []; });
                state.roundDealers = [];
                state.undoStack = [];
                sounds.click();
                save();
                render();
                alert('‚úÖ Scores reset!');
            }
        });
        
        document.getElementById('resetPlayersBtn').addEventListener('click', () => {
            if (confirm('‚ö†Ô∏è Delete ALL players? Cannot be undone!')) {
                state.players = [];
                state.roundDealers = [];
                state.undoStack = [];
                sounds.click();
                save();
                render();
                alert('‚úÖ Players deleted!');
            }
        });
        
        document.getElementById('addPlayerBtn').addEventListener('click', addPlayer);
        document.getElementById('newPlayerName').addEventListener('keypress', e => {
            if (e.key === 'Enter') addPlayer();
        });
        
        document.getElementById('targetPoint').addEventListener('change', function() {
            state.targetPoint = parseInt(this.value) || 330;
            save();
            render();
        });
        
        document.getElementById('sortBy').addEventListener('change', function() {
            state.sortBy = this.value;
            save();
            render();
        });
        
        document.getElementById('gameName').addEventListener('input', function() {
            state.gameName = this.value;
            save();
        });
        
        document.getElementById('reportBtn').addEventListener('click', showReport);
        document.getElementById('saveGameBtn').addEventListener('click', saveGame);
        document.getElementById('loadGamesBtn').addEventListener('click', loadGames);
        document.getElementById('clearHistoryBtn').addEventListener('click', clearHistory);
        document.getElementById('viewStatsBtn').addEventListener('click', viewStats);
        document.getElementById('refreshStatsBtn').addEventListener('click', () => {
            updateStats();
            alert('‚úÖ Stats refreshed!');
        });
        
        window.onclick = e => {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        };
    });
</script>
```

</body>
</html>
